# 효진유통 AI 에이전트팀 구축 기획서

**버전:** v3.0 | **작성일:** 2026년 2월  
**인프라:** Oracle Cloud A1.Flex (Always Free) | **에이전트:** OpenClaw | **LLM:** Google Gemini API  
**월 예산 한도:** 450$ (절대 초과 불가) | **일 예산 한도:** 15$ (절대 초과 불가)

---

## 1. 프로젝트 개요

효진유통의 모든 업무를 자동화·지능화하기 위한 멀티 AI 에이전트팀을 구축한다. 비서실장 에이전트가 대표자와 1:1 텔레그램으로 소통하며 전체 에이전트를 총괄하고, 각 팀 에이전트는 실무를 처리한다. 모든 에이전트는 OpenClaw 플랫폼으로 구현되며 Google Gemini API를 통해 필요 시마다 LLM을 호출한다.

> **1차 목표:** 에이전트 생성 및 기본 구조 배포만 완료. 루틴 설정 및 업무 할당은 추후 단계에서 진행.

| 항목 | 내용 |
|------|------|
| 목적 | 효진유통 전 업무 AI 자동화 및 대표자 의사결정 지원 |
| 범위 | 경영·마케팅·디자인·재무·고객응대 5개 팀 + 비서실장 |
| 인터페이스 | 텔레그램 (대표자 ↔ 비서실장 1:1 채팅) |
| 월 예산 한도 | **450$ (절대 초과 불가)** |
| 일 예산 한도 | **15$ (절대 초과 불가)** |
| 개발 도구 | Claude Code (전체 코딩 자동화) & Google Antigravity (전체 코딩 자동화) |

---

## 2. 시스템 아키텍처

### 2.1 전체 구조

대표자(텔레그램) ↔ 비서실장 에이전트(OpenClaw / Oracle Cloud A1) ↔ 5개 팀 에이전트 ↔ Google Gemini API(gemini-3-flash, gemini-3.1-pro) ↔ PostgreSQL on A1 (데이터 저장)

### 2.2 요청 처리 흐름 (시퀀스 예시)

1. 대표자 → "이번 달 ROAS 분석해줘"
2. → 비서실장 (Sonnet으로 의도 파악 + 담당 팀 라우팅)
3. → 마케터 에이전트 (Haiku로 광고 데이터 수집·분석)
4. → PostgreSQL에서 광고 데이터 조회
5. → 비서실장 (Sonnet으로 보고서 정리)
6. → 대표자에게 텔레그램 응답

### 2.3 인프라 구성요소

| 요소 | 역할 비유 | 실제 역할 |
|------|----------|---------| 
| OpenClaw | 사람의 몸 | 에이전트 실행 엔진 — 생성·라우팅·메시지 처리 |
| Google Gemini API | 사람의 뇌 | 실제 사고·판단·분석 (gemini-3-flash, gemini-3.1-pro 동적 할당) |
| PostgreSQL (A1 내부) | 뇌의 저장공간 | 대화기록·분석결과·파일·에이전트 메모리 영구 저장 |
| Oracle Cloud A1 | 지구 인프라 | 24시간 서버 운영 — OpenClaw + DB 모두 A1에서 호스팅 |

---

## 3. Oracle Cloud A1.Flex — Always Free 인프라

> **절대 원칙:** Oracle Cloud Always Free 무료 범위를 절대 초과하지 않는다. 유료 리소스는 어떤 경우에도 사용하지 않으며, 무료 한도 최대치로 운영한다.

### 3.1 Always Free A1.Flex 무료 사양 (최대치)

| 리소스 | 무료 한도 (최대) | 비고 |
|--------|----------------|------|
| OCPU (ARM) | **최대 4 OCPU** | 필요에 따라 유연하게 배분 |
| 메모리 | **최대 24 GB RAM** | 필요에 따라 유연하게 배분 |
| 부트 볼륨 + 블록 스토리지 | **최대 200 GB** | 부트 볼륨 최소 50GB 필요 |
| 오브젝트 스토리지 | 최대 20 GB | 백업 등 필요 시 활용 |
| 아카이브 스토리지 | 최대 10 GB | 장기 보관 필요 시 활용 |
| 아웃바운드 데이터 전송 | 10 TB/월 | 충분한 여유 |
| 공용 IPv4 주소 | 최대 6개 | 1개 사용 |
| 볼륨 백업 | 최대 5개 | 필요 시 정기 백업 |
| AMD Micro VM (추가) | 2개 (각 1/8 OCPU, 1GB RAM) | 모니터링 등 필요 시 활용 |

### 3.2 무료 범위 초과 방지 규칙

| 규칙 | 내용 |
|------|------|
| 인스턴스 수 제한 | A1.Flex 1개만 생성. 추가 인스턴스 생성 금지 |
| 블록 볼륨 | 200GB 절대 초과 금지. 사용 전 잔여 용량 확인 |
| 네트워크 | Load Balancer 무료 1개만 사용. 추가 LB 금지 |
| 오브젝트 스토리지 | 20GB 이내. 초과 시 아카이빙으로 이동 |
| 과금 알림 | OCI 예산(Budget) 기능으로 $0 임계값 알림 설정 — 과금 감지 즉시 알림 |
| Shape 변경 금지 | A1.Flex에서 유료 Shape으로 절대 변경 금지 |
| 유료 서비스 금지 | Autonomous DB, 유료 LB, 프리미엄 네트워크 등 유료 서비스 사용 금지 |

### 3.3 유휴 인스턴스 회수 방지

> ⚠️ Oracle은 CPU·네트워크·메모리 사용량이 7일간 20% 미만인 유휴 인스턴스를 회수할 수 있다.

**방지 대책:**
- OpenClaw + PostgreSQL이 상시 가동되므로 기본적으로 유휴 상태 어려움
- 추가 안전장치: Cron Job으로 5분마다 자체 헬스체크 실행하여 최소 활동 유지
- AMD Micro VM(무료 2개) 중 1개를 모니터링 전용으로 운영하여 A1 인스턴스 상태 감시
- OCI 인스턴스 모니터링 알림 설정 — 회수 경고 즉시 텔레그램 알림

### 3.4 A1 내부 서비스 구성

A1.Flex 인스턴스 하나에 모든 서비스를 Docker Compose로 운영한다. 리소스는 실제 부하에 따라 유동적으로 사용되며, 무료 한도 내에서 필요한 만큼만 할당한다.

| 서비스 | 역할 |
|--------|------|
| OpenClaw | 에이전트 엔진 + 텔레그램 봇 |
| PostgreSQL | 대화기록·분석결과·비용로그·메모리 저장 |
| Nginx (리버스 프록시) | HTTPS 종단, Webhook 수신, 보안 게이트웨이 |
| 모니터링·헬스체크 | 자체 상태 감시 + 예산 체크 |

---

## 4. OpenClaw 플랫폼 상세

> OpenClaw는 현재 가장 핫한 오픈소스 개인 AI 에이전트 플랫폼이다. 무료이며, 로컬 또는 서버에서 실행 가능하고, 텔레그램·슬랙·디스코드 등 50+개 메신저와 통합된다.

### 4.1 핵심 기능

| 기능 | 설명 |
|------|------|
| Any Chat App | WhatsApp, Telegram, Discord, Slack, Signal 등 어떤 채팅앱에서든 동작 |
| Persistent Memory | 사용자 선호도·컨텍스트를 기억하여 개인화된 AI 에이전트 구현 |
| Browser Control | 웹 브라우징, 폼 입력, 데이터 추출 가능 |
| Full System Access | 파일 읽기/쓰기, 쉘 명령 실행, 스크립트 실행 (샌드박스 모드 지원) |
| Skills & Plugins | 커뮤니티 스킬 확장 또는 자체 스킬 개발 가능 (ClawHub 마켓플레이스) |

### 4.2 비용 구조

| 항목 | 비용 |
|------|------|
| OpenClaw 소프트웨어 | **$0 (무료 오픈소스)** |
| LLM API 비용 | 별도 (Google Gemini API 요금 청구) |
| 호스팅 | Oracle Cloud A1.Flex (Always Free — $0) |

### 4.3 OpenClaw 보안 현황 및 알려진 취약점

| 취약점 | 심각도 | 설명 |
|--------|--------|------|
| CVE-2026-25253 (RCE) | Critical (CVSS 8.8) | 인증 없는 공격자가 조작된 링크로 게이트웨이 장악 가능. v2026.1.29에서 패치됨 |
| 프롬프트 인젝션 | High | 악성 콘텐츠에 숨겨진 명령어가 에이전트 동작을 탈취 가능 |
| 인증 없는 노출 인스턴스 | High | 전 세계 40,000+개 인스턴스가 인증 없이 공개 인터넷에 노출 |
| 악성 Skills | Medium | ClawHub 스킬 중 7.1%가 민감 정보 유출 확인 |
| Confused Deputy 문제 | Medium | 에이전트가 상승된 권한으로 유해 작업 수행에 악용 가능 |

> ⚠️ OpenClaw는 반드시 최신 버전(v2026.1.29+)으로 유지하고, 섹션 12의 보안 강화 조치를 전부 적용해야 한다.

---

## 5. AI 에이전트팀 구성

> **현 단계 방침:** 에이전트 생성 및 기본 프롬프트 설정까지만 완료. 구체적 루틴·업무 할당은 실제 운영 후 단계적으로 추가.

### 비서실장 (총괄)

- 대표자와 1:1 텔레그램 소통
- 모든 팀 리더에게 대표자를 대리하여 명령 권한 보유
- 각 팀 보고를 취합하여 대표자에게 통합 보고
- 대표자와 일상 소통 및 업무에서는 gemini-3-flash 호출
- 타 에이전트들에게 업무 지시 및 위임, 중요 의사결정 시 모두 gemini-3.1-pro 호출

### 팀별 에이전트 (1차: 생성만 완료)

| 팀 | 에이전트명 | 담당 영역 | 업무 할당 |
|----|-----------|---------|---------| 
| 경영팀 | 기획PM | 시장조사·키워드·소싱·인사 | 추후 설정 |
| 마케팅팀 | 마케터 | 광고 데이터·ROAS·전략 | 추후 설정 |
| 디자인팀 | 디자이너 | 썸네일·상세페이지·이미지 생성 | 추후 설정 |
| 재무팀 | 재무담당 | 매출·원가·인건비·세무 | 추후 설정 |
| 고객응대팀 | CS담당 | 플랫폼별 문의·전화 연동 | 추후 설정 |

---

## 6. LLM 동적 할당 전략

### 6.1 모델 라우팅 규칙

| 에이전트 | 실무 처리 | 비서실장 보고 | 의사결정 |
|---------|---------|------------|--------|
| 비서실장 | gemini-3-flash | — | gemini-3.1-pro |
| 기획PM | gemini-3-flash ~ gemini-3.1-pro | gemini-3.1-pro | — |
| 마케터 | gemini-3-flash ~ gemini-3.1-pro | gemini-3.1-pro | — |
| 디자이너 | gemini-3-flash ~ gemini-3.1-pro | gemini-3.1-pro | — |
| 재무담당 | gemini-3-flash ~ gemini-3.1-pro | gemini-3.1-pro | — |
| CS담당 | gemini-3-flash ~ gemini-3.1-pro | gemini-3.1-pro | — |

> 팀 에이전트 실무 처리는 기본적으로 gemini-3-flash를 사용하되, 복잡한 분석이나 높은 품질이 필요한 작업에는 gemini-3.1-pro로 자동 업그레이드한다. 단, BudgetGuard의 일/월 예산 허용 범위 내에서만 가능하다.

### 6.2 라우팅 로직 (구현 방향)

비서실장 시스템 프롬프트에 조건 삽입:
- 일반 소통 → gemini-3-flash
- 키워드 감지 ("최종결정", "전략 승인", "중요") → gemini-3.1-pro
- 팀 실무 (기본) → gemini-3-flash
- 팀 실무 (복잡한 분석·긴 보고서 작성 등) → gemini-3.1-pro (예산 허용 시)
- 팀 → 비서실장 보고 → gemini-3.1-pro

### 6.3 모델 버전 및 확장성 (Model Versioning & Extensibility)

1. **안정성 (Stability) 보장**: 모델의 잦은 업데이트로 인한 파싱 에러나 프롬프트 동작 불일치를 막기 위해 **반드시 버전이 고정된 모델명**(`gemini-3.1-pro-001`, `gemini-3.0-flash-001` 등)을 사용합니다. `latest` 태그는 절대 사용하지 않습니다.
2. **확장성 (Extensibility) 확보**: 향후 더 뛰어난 성능과 가성비를 지닌 대체 LLM 모델이 출시되었을 경우 즉시 교체할 수 있도록, 시스템 코드 내에 **모델명이나 특정 API 구조를 하드코딩하지 않습니다**. 
   - LLM 제공자, 모델명, 엔드포인트 등은 100% 환경변수(`.env`)로 분리하여 관리합니다.
   - OpenClaw의 기본 Provider 인터페이스나 호환 어댑터를 활용하여, 설정 파일 수정만으로 모델을 스왑(Swap)할 수 있는 모듈화된 구조로 구현합니다.

---

## 7. 비용 강제 제한 전략 (절대 초과 불가)

> **핵심 원칙:** 월 450$ / 일 15$를 절대 초과하지 않는다. 3중 안전장치를 적용한다.

### 7.1 예산 구조

| 구분 | 한도 | 비고 |
|------|------|------|
| 월 총 한도 | **450$** | 모든 비용 합산 기준 |
| 일 한도 | **15$** | 초과 시 전체 에이전트 자동 중단 |
| 목표 운영비 | 월 450$ | 실제 예상 운영 비용 (인프라 $0이므로 API만) |

### 7.2 3중 안전장치

**1차 방어 — Google Gemini API 콘솔 Hard Limit**

Google Gemini 계정 자체에서 과금 한도를 설정한다. 이 설정이 가장 확실한 안전장치이다.
- Monthly Spend Limit: **$450**

**2차 방어 — 서버 레벨 일일 예산 차단기 (BudgetGuard)**

OpenClaw 서버에 미들웨어로 예산 차단 로직을 구현한다.
- 모든 API 호출 전 PostgreSQL의 api_usage_log 테이블에서 금일/이번달 사용량을 조회
- 일 한도(15$) 또는 월 한도(450$) 도달 시 API 호출을 차단하고 대표자에게 알림
- 모든 API 호출 후 모델명, 입출력 토큰 수, 비용(USD/KRW)을 즉시 기록

**3차 방어 — 실시간 텔레그램 알림**

| 알림 유형 | 조건 | 알림 내용 |
|----------|------|----------|
| 🟡 주의 | 일 예산 70% (10.5$) 도달 | "오늘 API 비용 70% 사용. 나머지 4.5$" |
| 🟠 경고 | 일 예산 90% (13.5$) 도달 | "일 예산 90% 도달. gemini-3-flash 전용 모드 자동 전환" |
| 🔴 차단 | 일 예산 100% (15$) 도달 | "금일 API 한도 도달. 내일 자정까지 에이전트 중단" |
| 🔴 월간 차단 | 월 예산 100% (450$) | "월 API 한도 도달. 다음 달 1일까지 전체 중단" |

### 7.3 예산 절약 자동 전환 규칙

- 일 사용량 70% 미만 → 정상 운영 (gemini-3-flash/gemini-3.1-pro 혼합)
- 일 사용량 70~90% → gemini-3-flash 전용 모드 (gemini-3.1-pro 호출 차단)
- 일 사용량 90% 초과 → 긴급 응답만 허용 (최소 gemini-3-flash)
- 일 사용량 100% → 전체 중단. 내일 자정에 자동 해제

### 7.4 비용 추적

- api_usage_log 테이블: 호출 시각, 에이전트명, 모델명, 입출력 토큰 수, USD 비용, KRW 비용 기록
- daily_cost_summary 뷰: 일별 총 비용 및 API 호출 횟수 집계
- monthly_cost_summary 뷰: 월별 총 비용 및 API 호출 횟수 집계

---

## 8. 기술 스택

| 구분 | 기술/서비스 | 비용 | 용도 |
|------|-----------|------|------|
| 에이전트 플랫폼 | OpenClaw (무료 오픈소스) | $0 | 멀티 에이전트 생성·관리·라우팅 |
| LLM | Google Gemini API | 종량제 | gemini-3-flash-001/gemini-3.1-pro-001 동적 호출 (버전 고정) |
| 서버 | Oracle Cloud A1.Flex (Always Free) | **$0** | 24시간 서버 운영 (4OCPU, 24GB RAM) |
| 데이터베이스 | PostgreSQL (A1 내 Docker) | **$0** | 대화기록·분석결과·비용로그·메모리 저장 |
| 리버스 프록시 | Nginx (A1 내 Docker) | **$0** | HTTPS 종단, Webhook 수신, 보안 게이트웨이 |
| SSL 인증서 | Let's Encrypt | **$0** | HTTPS 무료 인증서 자동 발급·갱신 |
| 메신저 | Telegram Bot API | $0 | 대표자 ↔ 비서실장 인터페이스 |
| 모니터링 | Cron + 자체 헬스체크 | **$0** | 유휴 회수 방지 + 서비스 상태 감시 |
| 코딩 도구 | Claude Code | — | 전체 시스템 자동 코딩·배포 |

---

## 9. 24시간 운영 보장

### 유휴 회수 방지

- OpenClaw + PostgreSQL 상시 가동으로 기본 활동 보장
- Cron Job: 5분마다 자체 헬스체크 + 서비스 상태 로깅
- OCI 리소스 모니터링: CPU·메모리·네트워크 사용률 20% 이상 유지 확인
- 회수 경고 감지 시 텔레그램 즉시 알림

---

## 10. 구현 단계

> **1차 배포 목표:** Oracle Cloud A1 세팅 + 에이전트 6개 생성 + 텔레그램 연결 + 예산 차단기 + 보안 강화까지 완료

| 단계 | 작업 | 세부 내용 | 상태 |
|------|------|---------|------|
| 1 | Oracle Cloud A1 세팅 | A1.Flex 인스턴스 생성(4OCPU, 24GB) + 보안그룹 + SSH 키 | 예정 |
| 2 | Docker 환경 구성 | Docker + Docker Compose 설치 + Nginx + PostgreSQL + OpenClaw 구성 | 예정 |
| 3 | SSL + 도메인 | Let's Encrypt HTTPS 설정 + 도메인 연결 (또는 OCI 퍼블릭 IP) | 예정 |
| 4 | 텔레그램 봇 | Bot 생성·Webhook 연결·기본 메시지 구조 | 예정 |
| 5 | 비서실장 에이전트 | OpenClaw 생성·LLM 라우팅 로직 | 예정 |
| 6 | 팀 에이전트 ×5 | 5개 에이전트 생성·기본 프롬프트 설정 | 예정 |
| 7 | PostgreSQL 연동 | 처리 결과 저장·메모리 시스템·비용 로그 테이블 | 예정 |
| 8 | 예산 차단기 구현 | BudgetGuard 미들웨어·알림 시스템·일/월 한도 차단 | 예정 |
| 9 | 보안 강화 | Docker 샌드박스·인증·네트워크 격리·스킬 감사·OCI 방화벽 | 예정 |
| 10 | 최종 점검·배포 | 보안 체크리스트 + 유휴 회수 방지 + OCI 예산 알림($0) 설정 | 예정 |
| 11 | 루틴·업무 할당 | 각 팀 구체적 임무·자동화 규칙 설정 | **추후** |
| 12 | 고도화 | 이미지 생성·KT AI 비서 연동 등 | **추후** |

---

## 12. 보안 강화 전략 (필수 적용)

> **원칙:** OpenClaw + Oracle Cloud 인프라 보안을 모두 강화한다. 1차 배포 시 반드시 적용.

### 12.1 Oracle Cloud 인프라 보안

| 조치 | 세부 |
|------|------|
| VCN 보안 목록 | 인바운드: SSH(22)은 관리자 IP만, HTTPS(443)은 텔레그램 Webhook IP만 허용. 그 외 전부 차단 |
| 게이트웨이 포트(18789) | 외부 노출 절대 금지. Nginx 리버스 프록시 뒤에서만 접근 |
| SSH 접근 | 키 기반 인증만 허용, 비밀번호 인증 비활성화, 포트 변경 권장 |
| OCI 방화벽 (iptables) | 서버 레벨에서도 불필요 포트 차단 |
| OCI 예산 알림 | $0 임계값 설정 — 과금 발생 즉시 이메일 알림 |

### 12.2 OpenClaw 버전 관리 및 패치

| 조치 | 세부 |
|------|------|
| 최소 버전 | v2026.1.29+ (CVE-2026-25253 패치 적용) |
| Docker 이미지 태그 | latest 사용 금지 → 이미지 digest 고정 |
| 정기 업데이트 | 주 1회 보안 패치 확인 및 적용 |
| 보안 감사 | openclaw security audit --deep --fix 주 1회 실행 |

### 12.3 인증 및 접근 제어

- 게이트웨이 토큰 인증 필수 (auth: none은 2026.02 이후 제거됨)
- openclaw doctor --generate-gateway-token 으로 강력 토큰 생성
- 토큰 로테이션: 30일마다 자동 교체
- DM 접근 정책: allowlist 모드 — 대표자 텔레그램 ID만 허용
- 텔레그램 chat_id 화이트리스트 적용 — 대표자 외 모든 메시지 무시

### 12.4 Docker 컨테이너 보안

- Docker 이미지 digest 고정 (latest 태그 사용 금지)
- 비-root 사용자(UID 1000)로 실행
- 읽기 전용 파일시스템 적용
- 모든 Linux 커널 권한 제거 (cap_drop: ALL)
- 임시 저장소는 tmpfs(100MB 제한)로만 허용
- CPU 1코어, 메모리 512MB 제한 (OpenClaw 컨테이너 단위)
- 격리된 Docker 내부 네트워크 구성

### 12.5 네트워크 보안

| 조치 | 세부 |
|------|------|
| 게이트웨이 포트(18789) | 공개 인터넷에 절대 노출 금지 — Nginx 뒤에서만 |
| 브라우저 제어 포트(18791) | 차단 (사용하지 않을 경우) |
| mDNS 비활성화 | 로컬 네트워크 내 다른 기기 탐색 방지 |
| Nginx 방화벽 | 인바운드: 텔레그램 Webhook IP만 / 아웃바운드: Gemini API만 허용 |

### 12.6 스킬(Plugin) 보안

| 조치 | 세부 |
|------|------|
| ClawHub | 기본 비활성화 — 필요 스킬만 수동 설치 |
| 설치 전 감사 | 스킬 내 쉘 명령, 네트워크 호출, 안전 지침 무시 명령어 검사 |
| 자동 업데이트 | 비활성화 — 수동으로만 업데이트 |
| 화이트리스트 | 필요한 도구(Tool)만 명시적으로 허용, 나머지 차단 |

### 12.7 API 키 및 비밀 관리

| 항목 | 방법 |
|------|------|
| Gemini API Key | 환경변수로만 관리 (코드 하드코딩 절대 금지) |
| Telegram Bot Token | 환경변수로만 관리 |
| PostgreSQL 비밀번호 | Docker secrets 또는 환경변수 |
| Gateway Token | 환경변수 + 30일 로테이션 |
| .env 파일 | .gitignore에 반드시 포함 |
| SSH 키 / 프로덕션 인증정보 | 워크스페이스 내 저장 절대 금지 |

### 12.8 프롬프트 인젝션 방어

- 모든 사용자 입력을 비신뢰(untrusted)로 취급
- "ignore previous instructions", "system prompt", "you are now" 등 인젝션 패턴 탐지 필터 구현
- 의심 패턴 감지 시 해당 요청 차단 + 대표자에게 텔레그램 알림
- 외부 웹 콘텐츠 처리 시에도 동일 필터 적용

### 12.9 보안 체크리스트 (배포 전 필수 확인)

- [ ] Oracle Cloud VCN 보안 목록 — 필요 포트만 개방 확인
- [ ] OCI 예산 $0 알림 설정 확인
- [ ] OpenClaw v2026.1.29+ 설치 확인
- [ ] 게이트웨이 토큰 생성 및 인증 활성화
- [ ] Docker 비-root 사용자 실행 확인
- [ ] 게이트웨이 포트 공개 인터넷 비노출 확인
- [ ] ClawHub 마켓플레이스 비활성화 확인
- [ ] 모든 API 키 환경변수로만 관리 확인
- [ ] 텔레그램 chat_id 화이트리스트 적용 확인
- [ ] BudgetGuard 일/월 한도 정상 작동 확인
- [ ] openclaw security audit --deep 실행 및 통과
- [ ] 프롬프트 인젝션 방어 활성화 확인

---

## 13. 업그레이드 로드맵

| Phase | 시점 | 내용 |
|-------|------|------|
| Phase 1 | 현재 | Oracle Cloud A1.Flex Always Free — 에이전트 생성·배포·보안 강화 완료 |
| Phase 2 | 안정화 후 | PostgreSQL 자동 백업 스크립트 + 오브젝트 스토리지 백업 |
| Phase 3 | 업무 할당 후 | 각 팀 루틴·자동화 규칙 단계적 추가 |
| Phase 4 | 고도화 | 이미지 생성·KT AI 비서 완전 연동 |

> 참고: Oracle Cloud Always Free로 인프라가 완전 무료이므로, 기존 Phase 2(Supabase Pro)와 Phase 4(Railway Pro)는 더 이상 필요 없음.

---

## 14. 리스크 및 대응

| 리스크 | 영향 | 대응 |
|--------|------|------|
| Oracle 유휴 인스턴스 회수 | 서버 중단 | Cron 헬스체크 + CPU 사용률 20% 이상 유지 + 회수 경고 알림 |
| Oracle Cloud 무료 정책 변경 | 유료 전환 필요 | OCI 예산 $0 알림 + 대안 인프라(Railway 등) 백업 계획 |
| Gemini API 비용 초과 | 예산 초과 | 3중 안전장치 (API 콘솔 Hard Limit + BudgetGuard + 알림) |
| OpenClaw 보안 취약점 | 시스템 탈취·데이터 유출 | 섹션 12 전체 적용 (Docker 격리, VCN 보안, 인증, 스킬 감사) |
| 프롬프트 인젝션 | 에이전트 동작 탈취 | 인젝션 탐지 필터 + 외부 입력 전체 비신뢰 처리 |
| API 키 유출 | 과금 폭주·데이터 접근 | 환경변수 전용 + 코드 내 하드코딩 금지 + 30일 토큰 로테이션 |
| A1 인스턴스 장애 | 서비스 중단 | PostgreSQL pg_dump 일일 백업 → 오브젝트 스토리지 저장 |

---

## 15. 성공 기준 (정량 지표)

| 기준 | 목표치 |
|------|--------|
| 비서실장 ↔ 텔레그램 응답 시간 | 10초 이내 |
| 6개 에이전트 생성 완료 | 6/6 정상 작동 |
| LLM 라우팅 정확도 (의도한 모델 호출 비율) | 95% 이상 |
| Oracle Cloud A1 월간 업타임 | 99% 이상 |
| 에이전트 오류율 (실패 응답 비율) | 5% 미만 |
| 월 전체 비용 | 450$ 이하 (절대) |
| 일 전체 비용 | 15$ 이하 (절대) |
| Oracle Cloud 과금 | **$0 (무료 범위 내 절대 유지)** |
| 보안 체크리스트 통과율 | 100% (전 항목) |

---

## 추가 구현 리스트

1. Oracle Cloud A1.Flex 인스턴스 확인 및 SSH 접속 설정
2. OCI 예산 $0 알림 설정 (과금 사전 차단)
3. Docker + Docker Compose 설치 및 서비스 구성
4. OpenClaw v2026.1.29+ 설치 및 보안 설정 적용
5. Claude Code로 비서실장 에이전트부터 구현 시작
6. BudgetGuard (예산 차단기) 가장 먼저 구현하여 비용 안전장치 확보
7. 보안 체크리스트 전 항목 통과 후 최종 배포

---

## 16. AI 개발자(Claude Code)를 위한 특별 지침 (Developer Guidelines)

이 기획서를 읽고 구현을 담당하는 AI 개발자(Claude Code)는 아래 지침을 최우선으로 준수해야 합니다.

1. **단계적 구현 목표**: 전체 시스템 코드를 한 번에 짜지 말고, 논리적인 순서로 작업을 분리하여 단계별로 진행하세요.
   - **Phase 1**: 프로젝트 초기화, 뼈대 구조 생성(`.env.example`, `docker-compose.yml`, 프로젝트 디렉토리)
   - **Phase 2**: Nginx 보안 리버스 프록시 및 PostgreSQL 스키마(요금 추적 등) 구성
   - **Phase 3**: OpenClaw와 Telegram Bot Webhook 연동 및 핵심 보안(Gateway Token) 설정
   - **Phase 4**: **BudgetGuard 미들웨어 심기 (매우 중요)**
   - **Phase 5**: 비서실장 에이전트용 특화 프롬프트 및 라우팅 로직 적용
2. **비용 한도 절대 준수**: 일 $15 예산을 지킬 수 있도록 LLM 요청 전 DB를 쿼리해 리미트를 확인하고 강제 블록하는 로직이 100% 동작해야 합니다.
3. **보안 지향 코드**: `.env`에 모든 Secret 키 분리, 비즈니스 및 내부 파일 시스템 접근 제한 적용 등 기획서 내 보안 가이드를 코드에 반영하세요.
4. **리뷰 요청**: 핵심 모델 연동이나 데이터베이스 뼈대 작성 시, 사용자(사용자 PC)에서 실행하거나 배포하기 적절한지 사용자에게 컨펌/질문 후 진행하세요.
5. **확장성 고려한 LLM 연동**: 향후 언제든 더 좋은 프론티어 모델로 교체할 수 있도록, LLM Provider와 모델 이름은 절대 코어 로직에 하드코딩하지 말고 환경 변수에 분리하며, 교체를 대비한 모듈화된 설계를 하세요.
